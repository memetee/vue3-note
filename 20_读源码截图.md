

## 读源码

给这里加上sourcemap

这样打包以后的代码就有sourcemap，调试的时候就好调试了



![image-20210630222609296](C:\Users\小山\AppData\Roaming\Typora\typora-user-images\image-20210630222609296.png)



![image-20210630222951142](C:\Users\小山\AppData\Roaming\Typora\typora-user-images\image-20210630222951142.png)





不管什么前端框架，一般都是用npm管理，所以我们可以先看 packge.json

![image-20210630223824745](C:\Users\小山\AppData\Roaming\Typora\typora-user-images\image-20210630223824745.png)



chalk这个插件，是给控制台添加颜色的。

执行npm run dev

![image-20210630224326875](C:\Users\小山\AppData\Roaming\Typora\typora-user-images\image-20210630224326875.png)

等待们修改源码

![image-20210630225115229](C:\Users\小山\AppData\Roaming\Typora\typora-user-images\image-20210630225115229.png)

![image-20210630225234090](C:\Users\小山\AppData\Roaming\Typora\typora-user-images\image-20210630225234090.png)

![image-20210630225336354](C:\Users\小山\AppData\Roaming\Typora\typora-user-images\image-20210630225336354.png)

找到它

![image-20210630225554361](C:\Users\小山\AppData\Roaming\Typora\typora-user-images\image-20210630225554361.png)



上面打包的代码在哪呢？

![image-20210630225634064](C:\Users\小山\AppData\Roaming\Typora\typora-user-images\image-20210630225634064.png)

![image-20210630225808854](C:\Users\小山\AppData\Roaming\Typora\typora-user-images\image-20210630225808854.png)



![image-20210630225928598](C:\Users\小山\AppData\Roaming\Typora\typora-user-images\image-20210630225928598.png)



![image-20210701214105380](C:\Users\小山\AppData\Roaming\Typora\typora-user-images\image-20210701214105380.png)



![image-20210701214244423](C:\Users\小山\AppData\Roaming\Typora\typora-user-images\image-20210701214244423.png)

就会显示了

那么从我们想createApp，到mount到页面显示，vue内部是如何做的呢？

![image-20210701221017516](C:\Users\小山\AppData\Roaming\Typora\typora-user-images\image-20210701221017516.png)



![image-20210701221214196](C:\Users\小山\AppData\Roaming\Typora\typora-user-images\image-20210701221214196.png)



![image-20210701221329995](C:\Users\小山\AppData\Roaming\Typora\typora-user-images\image-20210701221329995.png)



![image-20210701222124538](C:\Users\小山\AppData\Roaming\Typora\typora-user-images\image-20210701222124538.png)



![image-20210701222222309](C:\Users\小山\AppData\Roaming\Typora\typora-user-images\image-20210701222222309.png)



![image-20210701222427259](C:\Users\小山\AppData\Roaming\Typora\typora-user-images\image-20210701222427259.png)



![image-20210701222558099](C:\Users\小山\AppData\Roaming\Typora\typora-user-images\image-20210701222558099.png)

![image-20210701223606907](C:\Users\小山\AppData\Roaming\Typora\typora-user-images\image-20210701223606907.png)

![image-20210701224057340](C:\Users\小山\AppData\Roaming\Typora\typora-user-images\image-20210701224057340.png)

调的就是这个函数

![image-20210701224219923](C:\Users\小山\AppData\Roaming\Typora\typora-user-images\image-20210701224219923.png)



这个函数非常长，最后返回了这么个对象。

![image-20210701224344733](C:\Users\小山\AppData\Roaming\Typora\typora-user-images\image-20210701224344733.png)



![image-20210701224553735](C:\Users\小山\AppData\Roaming\Typora\typora-user-images\image-20210701224553735.png)



render函数也有传过来

![image-20210701224708316](C:\Users\小山\AppData\Roaming\Typora\typora-user-images\image-20210701224708316.png)

![image-20210701225508860](C:\Users\小山\AppData\Roaming\Typora\typora-user-images\image-20210701225508860.png)

![image-20210702222728155](C:\Users\小山\AppData\Roaming\Typora\typora-user-images\image-20210702222728155.png)

![image-20210702222924467](C:\Users\小山\AppData\Roaming\Typora\typora-user-images\image-20210702222924467.png)



![image-20210702223247247](C:\Users\小山\AppData\Roaming\Typora\typora-user-images\image-20210702223247247.png)



总的来说，我们在调用createApp的时候，返回给我们一个app对象，这个app对象里面有很多东西，包括mixin，component，mount等

![image-20210702223829163](C:\Users\小山\AppData\Roaming\Typora\typora-user-images\image-20210702223829163.png)

![image-20210702224258965](C:\Users\小山\AppData\Roaming\Typora\typora-user-images\image-20210702224258965.png)

![image-20210702224419508](C:\Users\小山\AppData\Roaming\Typora\typora-user-images\image-20210702224419508.png)



![image-20210702224739406](C:\Users\小山\AppData\Roaming\Typora\typora-user-images\image-20210702224739406.png)

这样做的目的是为了实现跨平台，安卓或者ios不支持document.queryselector这样获取元素。

创建vnode

![image-20210702225328061](C:\Users\小山\AppData\Roaming\Typora\typora-user-images\image-20210702225328061.png)



![image-20210702225430585](C:\Users\小山\AppData\Roaming\Typora\typora-user-images\image-20210702225430585.png)



在这里传过来render

![image-20210702225556300](C:\Users\小山\AppData\Roaming\Typora\typora-user-images\image-20210702225556300.png)



所以上面调render函数实际上调的是这个

![image-20210702225718384](C:\Users\小山\AppData\Roaming\Typora\typora-user-images\image-20210702225718384.png)



这里把vnode的传到了patch里面

![image-20210703210320345](C:\Users\小山\AppData\Roaming\Typora\typora-user-images\image-20210703210320345.png)



![image-20210703210341723](C:\Users\小山\AppData\Roaming\Typora\typora-user-images\image-20210703210341723.png)



![image-20210703210623040](C:\Users\小山\AppData\Roaming\Typora\typora-user-images\image-20210703210623040.png)



![image-20210703210708715](C:\Users\小山\AppData\Roaming\Typora\typora-user-images\image-20210703210708715.png)

![image-20210703211548988](C:\Users\小山\AppData\Roaming\Typora\typora-user-images\image-20210703211548988.png)

刚才做的事这些事

![image-20210703210931088](C:\Users\小山\AppData\Roaming\Typora\typora-user-images\image-20210703210931088.png)





![image-20210703211459737](C:\Users\小山\AppData\Roaming\Typora\typora-user-images\image-20210703211459737.png)

![image-20210703213017832](C:\Users\小山\AppData\Roaming\Typora\typora-user-images\image-20210703213017832.png)



![image-20210703213051964](C:\Users\小山\AppData\Roaming\Typora\typora-user-images\image-20210703213051964.png)



对它赋值

![image-20210703213357321](C:\Users\小山\AppData\Roaming\Typora\typora-user-images\image-20210703213357321.png)



看这里

![image-20210703213619397](C:\Users\小山\AppData\Roaming\Typora\typora-user-images\image-20210703213619397.png)



![image-20210703214131806](C:\Users\小山\AppData\Roaming\Typora\typora-user-images\image-20210703214131806.png)



分情况

![image-20210703214224893](C:\Users\小山\AppData\Roaming\Typora\typora-user-images\image-20210703214224893.png)





![image-20210703220525419](C:\Users\小山\AppData\Roaming\Typora\typora-user-images\image-20210703220525419.png)



![image-20210703220759245](C:\Users\小山\AppData\Roaming\Typora\typora-user-images\image-20210703220759245.png)





![image-20210703220910293](C:\Users\小山\AppData\Roaming\Typora\typora-user-images\image-20210703220910293.png)



![image-20210703221250781](C:\Users\小山\AppData\Roaming\Typora\typora-user-images\image-20210703221250781.png)



挂载如果是element也一样

![image-20210703221621712](C:\Users\小山\AppData\Roaming\Typora\typora-user-images\image-20210703221621712.png)

![image-20210703221703149](C:\Users\小山\AppData\Roaming\Typora\typora-user-images\image-20210703221703149.png)



它会依次挂载，包括子元素，挂载

挂载完以后就会在界面展示。

![App组件的挂载和渲染过程](D:\studyMaterial\vue3\上课资料\课堂资料day01_21\课堂\上课画图\App组件的挂载和渲染过程.png)

这样一个过程





执行debugger可以看到每一个

源码这部分没有截图了，因为逻辑太多了。如果想看，可以看视频
